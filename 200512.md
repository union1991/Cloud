# Day 2.

## 목차
 
### 3. TCP/IP
 
> #### 3.1 이더넷 프로토콜 구조
 
> #### 3.2 주소 결정 프로토콜
 
> #### 3.3 인터넷 프로토콜

> #### 3.4 인터넷 제어 메시지 프로토콜
 
 ------------
 
## 3. TCP/IP
 
국제표준기준인 OSI 7 Layer를 간략화 시킨 실질적인 모델이다.

 ------------
  
#### 3.1 이더넷 프로토콜 구조
 
 * Preamble : Frame 전송의 시작을 나타내는 필드,  10101010이 반복되는 7바이트 길이의 필드
 * SOF(SFD) : Frame의 시작을 알리는데 사용
 * 목적지 주소 : 수신지의 MAC 주소
 * 출발지 주소 : 출발지의 MAC 주소
 * 타입 or 길이 : 상위 계층 프로토콜 데이터 필드의 길이나 MAC 클라이언트의 종류를 표시
 * 데이터 : 상위 계층에서 받은 캡슐화 된 데이터(패킷)
 * FCS : 오류 검출용 필드

---

#### 3.2 주소 결정 프로토콜(Address Resolution Protocol, ARP)
 
 네트워크 상에서 IP 주소를 물리적 네트워크 주소로 대응(bind)시키기 위해 사용되는 프로토콜
 
  <br>
  
 * ARP 실습하기
 > 1. arp 설치 **"sudo apt-get install net-tools"**
 > 2. 현재 학습되어 있는 MAC 주소를 확인한다. **"arp -a"**
 > 3. ping으로 옆자리 PC에 ping을 보낸다. **"ping 192.168.*.*"**
 > 4. 상대의 MAC 주소를 학습하여 추가했는지 확인한다. **"arp -a"**
 > 5. 해당 정보는 **"arp -d 192.168.*.*"** 으로 삭제 가능하다.
  
  <br>
  
 * 실습 후 의문점
 > 1. 브로드캐스트 방식이면 다른 PC의 IP는 왜 나에게 학습되지 않는가? 
 > 2. 학습된 정보는 언제까지 기억되어 있는가?
  
  <br>
  
 ##### WireShark
 
 와이어샤크는 자유 및 오픈 소스 패킷 분석 프로그램으로 네트워크의 문제, 분석, 소프트웨어 및 통신 프로토콜 개발, 교육에 쓰인다. 스니핑 도구 중 하나로 볼 수 있다.
 
 * ubuntu 설치 시, 명령어 창에 **"sudo apt-get install wireshark"** 를 입력하고 모든 옵션은 **"Y"** 입력
 * wireshark 실행 시, 일반 계정으로 시작하면 인터페이스가 보이지 않아, **"sudo wireshark"** 로 실행
 <img src="https://user-images.githubusercontent.com/56064985/81627517-52b71b80-9439-11ea-833b-7234e894b7a0.png" width="90%"></img>
 * 사용 중인 인터페이스 확인은 **"ip a"** 명령어로 확인이 가능
 * wireshark의 사용 방법은 구글에 **"wireshark example"** 로 검색

---

 #### 3.3 아이피(Internet Protocol, IP)
 
 IP는 OSI의 Layer 3(Network Layer)와 Internet Protocol Suite의 Layer 3(Internet Layer)에 위치하는 프로토콜이지만, 일반적으로 인터넷 환경 자체를 의미하는 단어로 쓰인다.
 
 * ping이란,IP 네트워크를 통해 특정한 호스트가 도달할 수 있는지의 여부를 테스트하는 데 쓰이는 컴퓨터 네트워크 도구중 하나
 > 1. TTL(Time To Live) : 타임 투 리브는 컴퓨터나 네트워크에서 데이터의 유효 기간을 나타내기 위한 방법이다. TTL은 계수기나 타임스탬프의 형태로 데이터에 포함되며, 정해진 유효기간이 지나면 데이터는 폐기된다.( Window 운영체제 기반 : TTL=128, UNIX 운영체제 기반 : TTL=64, Others : TTL=255)
 > 2. 각 Router는 TTL 패킷이 날라올때 TTL Value를 1씩 감소시키고 TTL Value가 0인 값을 받았다면 Router는 그 패킷을 버리게 된다.
  
  <br>
  
 * 실습 
 > 1. 명령어 창에 **"sudo apt install inetutils-traceroute"** 을 입력하여 설치한다.
 > 2. 명령어 창에 **"sudo apt install traceroute"** 을 입력하여 추가로 설치한다.
  <img src="https://user-images.githubusercontent.com/56064985/81634100-34591c00-9449-11ea-8473-03381b2ed5cb.png" width="90%"></img>
 > 3. 명령어 창에 **"traceroute 8.8.8.8"** 을 입력하여 경로를 확인한다.
 > 4. 추가 정보는 구글에 **"ttl os fingerprinting"** 검색 
  
  <br>
  
 * IP 주소 체계
 > 1. A 클래스(첫 8비트) : 0XXXXXXX(네트워크.호스트.호스트.호스트), 0.0.0.0 ~ 127.255.255.255
 > 2. B 클래스(첫 8비트) : 10XXXXXX(네트워크.네트워크.호스트.호스트) 128.0.0.0 ~ 191.255.255.255
 > 3. C 클래스(첫 8비트) : 110XXXXX(네트워크.네트워크.네트워크.호스트) 192.0.0.0 ~ 223.255.255.255
 > 4. D 클래스(첫 8비트) : 1110XXXX(멀티캐스트를 위해 예약 되어 있음) 224.0.0.0 ~ 239.255.255.255
 > 5. E 클래스(첫 8비트) : 1111xxxx(실험 및 연구용) 240.0.0.0 ~ 254.255.255.255
  
  <br>
  
 * 서브넷 마스크
 
 > 1. 디폴트 서브넷 마스크  
 > * 클래스 A : 255.0.0.0
 > * 클래스 B : 255.255.0.0 
 > * 클래스 C : 255.255.255.0
  
 > 2. 서브넷 마스크 계산
 > * /24 일 경우 11111111.11111111.11111111.00000000 
 > * /26 일 경우 11111111.11111111.11111111.11000000 
 > * /28 일 경우 11111111.11111111.11111111.11110000
 
 > 3. 서브넷팅 연습문제
 > * 연습문제1) IP : 192.168.110.110, 넷마스크 : 255.255.255.225
 > * 답) CIDR : 27, 브로드 캐스트 : 192.168.110.127, 네트워크 주소 : 192.168.110.96-127, 2^27-2
 > * 연습문제2) IP : 192.168.200.78, 넷마스크 : 255.255.255.192
 > * 답) CIDR : 26, 브로드 캐스트 : 192.168.200.127, 네트워크 주소 : 192.168.200.64-127 , 2^26-2 
  
  
  <br>
  
 * 공인 아이피와 사설 아이피
 > 1. 공인 아이피 : 전 세계에서 유일하게 쓸 수 있는 IP, IPv4 주소 체계에서 모든 기기에 할당하기에 개수가 부족(약 43억 개)
 > 2. 사설 아이피 : IP 주소 부족 문제를 해결하기 위해 등장, 한 네트워크에 속한 사용자들끼리만 인식할 수 있는 임시 Ip 같은 네트워크 내에서 홈페이지를 만들어 서비스 또는 파일 주고받기 가능, 하지만 네트워크를 벗어나면 사설 IP를 그대로 사용할 수 없음
 > 3. 사설 아이피의 장점 : 하나의 공인 IP로 같은 네트워크를 사용하는 다수의 사용자에게 서비스 가능
 > 4. NAT(Network Address Translation) : 공인 IP와 사설 IP를 서로 변환하여 IP 부족 문제를 해결하고 외부 침입에 대한 보안을 높이는 기술
  
 ---
  
 #### 3.4 인터넷 제어 메시지 프로토콜(Internet Control Message Protocol, ICMP)
 
ICMP는 TCP/IP에서 IP 패킷을 처리할 때 발생되는 문제를 알려주는 프로토콜이다. IP에는 오로지 패킷을 목적지에 도달시키기 위한 내용들로만 구성되어 있다. 따라서 정상적으로 목적지 호스트에 도달하는 경우에는 IP에서 통신이 성공하고 종료되므로 아무런 문제가 없다.

* ICMP 특징
 > 1. 모든 IP 구현은 ICMP를 동반해야 한다.
 > 2. ICMP는 IP Packet과 함께 실행된다.
 > 3. ICMP는 오류보고나 제어 목적이지 IP Data Packet을 신뢰할 수 있는 전송을 가능케 함이 아니다.
 > 4. ICMP는 첫 번째 IP Datagram 단편화에 대해서만 오류를 보고한다.
 > 5. ICMP는 IP Datagram에 대한 오류보고 메커니즘이지 Datagram 문제에 관한 오류 메시지를 발생하지 않는다.
 > 6. 간혹 ICMP를 막아야 한다는 문서나 의견이 있지만, 시스템 엔지니어에게 있어 꼭 필요한 도구이기 때문에 해당 부분은 더 검토되어야 한다.
 
* ICMP type code
 > 2. Type 3 : 목적지 도달 불가(Destination Unreachable)
 > 3. Type 5 : 재지정(Redirect)
 > 5. Type 11 : 시간초과(Time Exceeded)
 > 6. Type 12 : 매개변수 문제(Parameter Problem)
 > 1. Type 0 : 에코 응답(Echo Reply)
 > 4. Type 8 : 에코 요청(Echo Request)

 -------------
 ## 금일 교육의 Key Point
 
 #### OSI 7 Layer 정리
