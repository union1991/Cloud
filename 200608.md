Day 20.

## 목차
 
### 9. 서버 환경 설정 

> #### 9.1 실습 1


------------
 
 
## 9 서버 환경 설정 


주어진 환경에 맞게 서버를 설치하고 환경 설정을 구성한다.


------------

 
#### 9.1 실습 1


다음과 같은 3대의 서버(storage, webserver, database)를 설치하고 아래 그림과 같은 서버를 구성하여라. 


<img src="https://user-images.githubusercontent.com/56064985/84008472-e8988480-a9ac-11ea-8a25-5465daa828e2.png" width="90%"></img>


* [storage 서버]


### 1. 해당 서버에는 먼저 nfs 디렉토리로 사용될 storage(10G)를 추가한다. 


<img src="https://user-images.githubusercontent.com/56064985/84009381-22b65600-a9ae-11ea-9a89-97521b47af5f.png" width="90%"></img>




### 2. 추가된 storage를 파티셔닝 한다.(현재 구성에서는 storage 전체를 사용하기 때문에 파티셔닝이 필요하지 않아도 됨)
```
# fdisk /dev/vdb 
  n(새로 만들기)   p(형식)   enter(파티셔닝 넘버)   enter(파티셔닝 섹션)   enter(파티셔닝 사이즈)   w(저장)

# mkfs.xfs /dev/vdb1  // vdb1을 xfs형식으로 지정
# blkid // 디바이스 확인
/dev/vdb1: UUID="af704215-0e30-4f18-9dba-fce9e0e708c1" TYPE="xfs" 
```



### 3. 추가된 storage와 해당 경로의 디렉토리를 마운트한다.
```
# mkdir -p /exportfs/web
# vi /etc/fstab
...

/dev/vdb1/      /exportfs/web/  xfs     defaults        0 0   // 디렉토리 명을 마운트(디렉토리의 이름이 변경되면 마운트 해제)

또는

UUID=af704215-0e30-4f18-9dba-fce9e0e708c1  /exportfs/web/  xfs     defaults        0 0    // UUID로 마운트(파일 시스템이 삭제되지 않는 한 해당 디렉토리의 이름이 변경되어도 마운트 유지 가능)

~                                                                       

:wq!

# mount -a    // /etc/fstab에 저장된 정보로 마운트 진행
# df -h   // 마운트된 목록 확인

```



### 4. nfs 서비스 패키지를 설치한다.
```
# yum install -y nfs-utils
# systemctl start nfs   // nfs 서비스 시작
# vi /etc/exports  // 공유할 디렉터리 설정을 저장
/exports/web     192.168.123.0/24(rw, no_root_squash, sync)       // squash 정책의 기본 설정은 nfs 클라이언트들의 모든 접근은 nfsnobody로 인식하여 권한에 한계가 발생. 해당 권한 문제를 해결하기 위해서는 'no_root_squash' 옵션으로 root 계정의 접근은 root로 인식(no_all_squash : 모든 클라이언트의 계정 인식)

```



